From 6dd0d5c894572b8acccc3c6c25e0af0725af8e4b Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey@solus-project.com>
Date: Fri, 10 Jun 2016 23:19:30 +0100
Subject: [PATCH 05/19] Undo borks so we can fail gracefully

Signed-off-by: Ikey Doherty <ikey@solus-project.com>
---
 os_installer2/diskops.py        | 2 --
 os_installer2/pages/progress.py | 2 ++
 os_installer2/postinstall.py    | 1 +
 3 files changed, 3 insertions(+), 2 deletions(-)

diff --git a/os_installer2/diskops.py b/os_installer2/diskops.py
index 74403ea..fae9cff 100644
--- a/os_installer2/diskops.py
+++ b/os_installer2/diskops.py
@@ -26,8 +26,6 @@ class BaseDiskOp:
 
     def __init__(self, device):
         self.device = device
-        if device.disk is not None:
-            self.disk = device.disk
 
     def describe(self):
         """ Describe this operation """
diff --git a/os_installer2/pages/progress.py b/os_installer2/pages/progress.py
index 926ca34..974af8d 100644
--- a/os_installer2/pages/progress.py
+++ b/os_installer2/pages/progress.py
@@ -81,6 +81,8 @@ class InstallerProgressPage(BasePage):
 
     def set_error_message(self, error_msg):
         """ Set the error message, i.e. something Super Bad happened """
+        if not error_msg:
+            error_msg = "[undefined error]"
         sys.stderr.write(error_msg + '\n')
         sys.stderr.flush()
         self.error_msgs.append(error_msg)
diff --git a/os_installer2/postinstall.py b/os_installer2/postinstall.py
index 5f6f1e4..50014e9 100644
--- a/os_installer2/postinstall.py
+++ b/os_installer2/postinstall.py
@@ -592,6 +592,7 @@ class PostInstallBootloader(PostInstallStep):
 
     def apply_bios(self):
         """ Take the BIOS approach to bootloader configuration """
+        self.set_errors("Sorry, still working on this BIOS doflickey!")
         return False
 
     def apply_uefi(self):
-- 
2.8.3

