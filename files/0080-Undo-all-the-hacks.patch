From a3bd4bc9150bbfbbc54a08203ff7737e043911c2 Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey@solus-project.com>
Date: Sun, 12 Jun 2016 23:07:56 +0100
Subject: [PATCH 80/85] Undo all the hacks

Signed-off-by: Ikey Doherty <ikey@solus-project.com>
---
 os_installer2/__init__.py       | 2 --
 os_installer2/diskman.py        | 2 +-
 os_installer2/pages/progress.py | 3 ++-
 3 files changed, 3 insertions(+), 4 deletions(-)

diff --git a/os_installer2/__init__.py b/os_installer2/__init__.py
index 86e03cd..64c4a64 100644
--- a/os_installer2/__init__.py
+++ b/os_installer2/__init__.py
@@ -22,8 +22,6 @@ gi.require_version('TimezoneMap', '1.0')
 
 # The path of the source filesystem
 SOURCE_FILESYSTEM = "/run/initramfs/live/LiveOS/squashfs.img"
-SOURCE_FILESYSTEM = \
-    "/home/ikey/Solus/primary/IMAGEROOT/deploy/LiveOS/squashfs.img"
 
 # The guy inside that is actually our filesystem to copy
 INNER_FILESYSTEM = "LiveOS/rootfs.img"
diff --git a/os_installer2/diskman.py b/os_installer2/diskman.py
index a11e64f..6fa2c4f 100644
--- a/os_installer2/diskman.py
+++ b/os_installer2/diskman.py
@@ -388,7 +388,7 @@ class DiskManager:
         }
 
         # Set up UEFI knowledge
-        if not os.path.exists("/sys/firmware/efi"):
+        if os.path.exists("/sys/firmware/efi"):
             self.is_uefi = True
             pl_f = "/sys/firmware/efi/fw_platform_size"
             if os.path.exists(pl_f):
diff --git a/os_installer2/pages/progress.py b/os_installer2/pages/progress.py
index b721dd8..2a787e6 100644
--- a/os_installer2/pages/progress.py
+++ b/os_installer2/pages/progress.py
@@ -31,7 +31,7 @@ from os_installer2.postinstall import PostInstallUsers
 from os_installer2.postinstall import PostInstallHostname
 from os_installer2.postinstall import PostInstallDiskOptimize
 from os_installer2.postinstall import PostInstallFstab
-# from os_installer2.postinstall import PostInstallBootloader
+from os_installer2.postinstall import PostInstallBootloader
 import os
 import stat
 import parted
@@ -117,6 +117,7 @@ class InstallerProgressPage(BasePage):
             PostInstallHostname,
             PostInstallDiskOptimize,
             PostInstallFstab,
+            PostInstallBootloader
         ]
         # Active postinstalls..
         self.post_installs = []
-- 
2.8.3

