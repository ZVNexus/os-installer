From a5b0d14e0c57111917097e244674e6e60fc1a620 Mon Sep 17 00:00:00 2001
From: Ikey Doherty <ikey@solus-project.com>
Date: Sun, 12 Jun 2016 14:22:34 +0100
Subject: [PATCH 51/51] Undo local hacks

Signed-off-by: Ikey Doherty <ikey@solus-project.com>
---
 os_installer2/__init__.py       | 5 +----
 os_installer2/diskman.py        | 2 +-
 os_installer2/pages/progress.py | 3 ++-
 3 files changed, 4 insertions(+), 6 deletions(-)

diff --git a/os_installer2/__init__.py b/os_installer2/__init__.py
index 68da5ea..64c4a64 100644
--- a/os_installer2/__init__.py
+++ b/os_installer2/__init__.py
@@ -21,10 +21,7 @@ gi.require_version('TimezoneMap', '1.0')
 
 
 # The path of the source filesystem
-# SOURCE_FILESYSTEM = "/run/initramfs/live/LiveOS/squashfs.img"
-
-SOURCE_FILESYSTEM = \
-    "/home/ikey/Solus/primary/IMAGEROOT/deploy/LiveOS/squashfs.img"
+SOURCE_FILESYSTEM = "/run/initramfs/live/LiveOS/squashfs.img"
 
 # The guy inside that is actually our filesystem to copy
 INNER_FILESYSTEM = "LiveOS/rootfs.img"
diff --git a/os_installer2/diskman.py b/os_installer2/diskman.py
index e25a147..3619ce6 100644
--- a/os_installer2/diskman.py
+++ b/os_installer2/diskman.py
@@ -384,7 +384,7 @@ class DiskManager:
         }
 
         # Set up UEFI knowledge
-        if not os.path.exists("/sys/firmware/efi"):
+        if os.path.exists("/sys/firmware/efi"):
             self.is_uefi = True
             pl_f = "/sys/firmware/efi/fw_platform_size"
             if os.path.exists(pl_f):
diff --git a/os_installer2/pages/progress.py b/os_installer2/pages/progress.py
index adbbd05..bb0ae8c 100644
--- a/os_installer2/pages/progress.py
+++ b/os_installer2/pages/progress.py
@@ -31,7 +31,7 @@ from os_installer2.postinstall import PostInstallUsers
 from os_installer2.postinstall import PostInstallHostname
 from os_installer2.postinstall import PostInstallDiskOptimize
 from os_installer2.postinstall import PostInstallFstab
-# from os_installer2.postinstall import PostInstallBootloader
+from os_installer2.postinstall import PostInstallBootloader
 import os
 import stat
 import parted
@@ -116,6 +116,7 @@ class InstallerProgressPage(BasePage):
             PostInstallHostname,
             PostInstallDiskOptimize,
             PostInstallFstab,
+            PostInstallBootloader
         ]
         # Active postinstalls..
         self.post_installs = []
-- 
2.8.3

